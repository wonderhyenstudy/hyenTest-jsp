<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mybatis="http://mybatis.org/schema/mybatis-spring"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd
       http://mybatis.org/schema/mybatis-spring http://mybatis.org/schema/mybatis-spring.xsd">

<!-- 아래 부분 테스트 에러난 것 : why?? -->
<!--<beans xmlns="http://www.springframework.org/schema/beans"-->
<!--       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"-->
<!--       xmlns:context="http://www.springframework.org/schema/context"-->
<!--       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">-->
<!--    빈 주입 -> 시스템에 객체를 넣어두기. (서버가 시작시, 해당 객체를 켜준다. 사용할 수 있게)  -->
<!--    서버 시작할때 아래 등록한 빈 객체를 시작해줘-->

<!-- 실습1 -->
    <!-- 빈 주입 (객체 등록과정)
-> 시스템에 객체를 넣어두기.(서버 시작시, 해당 객체를 켜준다, 사용할수 있게)-->
<!--    <bean class="com.busanit501.jsp_server_project1.springex_0212.sample._1_SampleDAO_0212"></bean>-->
<!--    <bean class="com.busanit501.jsp_server_project1.springex_0212.sample._2_SampleService_0212"></bean>-->


<!-- 실습2 -->
    <context:component-scan base-package="com.busanit501.jsp_server_project1.springex_0212.sample"/>

    <!-- 데이터베이스 관련 설정 , 매번 타이핑 하는게 아니다. 설정 파일은 복사를 한다. 꼭 기억하기.-->
    <!-- 변경하는 부분은, 옵션 부분, 계정, 비번, 포트 번호, 데이터베이스, 옵션 값(피씨 사양에 따라 달라서, 기본값.)-->
    <!-- 개발자가 이전에 직접 객체를 생성 : HikariConfig hikariConfig = new HikariConfig(); -->
    <bean id="hikariConfig" class="com.zaxxer.hikari.HikariConfig">
        <!-- 속성 옵션 설정해서, 작업.-->
        <property name="driverClassName" value="org.mariadb.jdbc.Driver"></property>
        <property name="jdbcUrl" value="jdbc:mariadb://localhost:3306/webdb"></property>
        <property name="username" value="webuser"></property>
        <property name="password" value="webuser"></property>
        <property name="dataSourceProperties">
            <props>
                <prop key="cachePrepStmts">true</prop>
                <prop key="prepStmtCacheSize">250</prop>
                <prop key="prepStmtCacheSqlLimit">2048</prop>
            </props>
        </property>
    </bean>

    <!-- 위에서 설정한 hikariConfig 설정을 , dataSource 인스턴스에 포함하기.-->
    <!--&lt;!&ndash; 생성자 주입으로 포함하기&ndash;&gt;-->
    <!-- public class DataSource {-->
    <!-- private HikariConfig hikariConfig-->
    <!-- }-->
    <bean id="dataSource" class="com.zaxxer.hikari.HikariDataSource"
          destroy-method="close">
        <constructor-arg ref="hikariConfig"/>
    </bean>

    <!-- Mybatis 기능을 , 전역 설정에 등록해서 이용할 준비. -->
    <!-- resource 폴더는 전체 설정 관련 접근을 위한 폴더이고, 접근시, classpath 접근 가능함,-->
    <!-- /mappers/** , ** 의미, mappers 폴더 밑에 아무 폴더 추가해도 상관없음.-->
    <!-- *.xml , 모든 xml 파일을 다 가리킴-->
    <!-- WEB-INF 하위에서 resources , css,js,image 등, 웹브라우저에게 제공하는 목적으로 사용함.-->
    <bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
        <property name="dataSource" ref="dataSource"/>
        <!-- <property name="mapperLocations" value="classpath:/mappers/**/*.xml"></property>-->
    </bean>

    <!-- 모델 맵퍼 이용하는 첫번째 방법, 해당 메서드에 애너테이션 안에 sql 문장을 등록해서 이용. -->
    <!-- 시스템에서, 해당 패키지의 애너테이션 존재 유무를 몰라요, -->
    <!-- 그래서, 시스템에 등록해서 이용해야함. -->
    <!-- 결론, 우리는 이방식으로 안하고, 파일 분리 형식으로 작업 할 예정. -->
    <mybatis:scan base-package="com.busanit501.jsp_server_project1.springex_0212.mapper"></mybatis:scan>



</beans>